var e=(e,t,s)=>new Promise((r,a)=>{var i=e=>{try{l(s.next(e))}catch(t){a(t)}},n=e=>{try{l(s.throw(e))}catch(t){a(t)}},l=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,n);l((s=s.apply(e,t)).next())});import{r as t,R as s}from"./react-vendor-DFd6LVBd.js";var r={exports:{}},a={},i=t,n=Symbol.for("react.element"),l=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,d=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function x(e,t,s){var r,a={},i=null,l=null;for(r in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!c.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:n,type:e,key:i,ref:l,props:a,_owner:d.current}}a.Fragment=l,a.jsx=x,a.jsxs=x,r.exports=a;var m=r.exports;const u=s.memo(({status:e})=>{const s=t.useMemo(()=>{switch(e){case"Final":return"bg-green-100 text-green-800";case"Preliminary":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},[e]);return m.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s}`,children:e})}),h=s.memo(({result:e,onDownload:t,downloading:s})=>m.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[m.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.id}),m.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.date}),m.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.type}),m.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:m.jsx(u,{status:e.status})}),m.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.patient}),m.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:()=>t("ldt",e.id),disabled:s,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150",children:s?"Downloading...":"LDT"}),m.jsx("button",{onClick:()=>t("pdf",e.id),disabled:s,className:"inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150",children:s?"Downloading...":"PDF"})]})})]})),p=s.memo(function({token:s,onLogout:r}){const[a,i]=t.useState([]),[n,l]=t.useState(!0),[o,d]=t.useState(""),[c,x]=t.useState(""),[u,p]=t.useState(""),[g,f]=t.useState(""),[b,y]=t.useState(!1),[w,j]=t.useState(1),[v]=t.useState(20),N=t.useMemo(()=>{let e=Array.isArray(a)?a:[];if(o){const t=o.toLowerCase();e=e.filter(e=>e.patient.toLowerCase().includes(t)||e.id.toLowerCase().includes(t)||e.type.toLowerCase().includes(t))}return c&&(e=e.filter(e=>e.status===c)),u&&(e=e.filter(e=>e.type===u)),e},[a,o,c,u]),k=t.useMemo(()=>{if(!Array.isArray(N))return[];const e=(w-1)*v,t=e+v;return N.slice(e,t)},[N,w,v]),S=t.useMemo(()=>Math.ceil(N.length/v),[N.length,v]),C=t.useMemo(()=>[...new Set(a.map(e=>e.status))],[a]),_=t.useMemo(()=>[...new Set(a.map(e=>e.type))],[a]),D=t.useCallback(()=>e(this,null,function*(){try{l(!0);const e=yield fetch("/api/results",{headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!e.ok){const t=yield e.text();throw new Error(`HTTP error! status: ${e.status} - ${t}`)}{const t=yield e.json();t&&"object"==typeof t&&t.results?i(Array.isArray(t.results)?t.results:[]):i([]),f("")}}catch(e){f(e.message||"Network error or server unavailable"),i([])}finally{l(!1)}}),[s]);t.useEffect(()=>{D()},[D]),t.useEffect(()=>{j(1)},[o,c,u]);const L=t.useCallback((t,r=null)=>e(this,null,function*(){var e;try{y(!0);const a=r?`/api/download/${t}/${r}`:`/api/download/${t}`,i=yield fetch(a,{headers:{Authorization:`Bearer ${s}`}});if(!i.ok)throw new Error(`Download failed: ${i.statusText}`);const n=yield i.blob(),l=window.URL.createObjectURL(n),o=document.createElement("a");o.href=l;const d=i.headers.get("content-disposition"),c=d?null==(e=d.split("filename=")[1])?void 0:e.replace(/"/g,""):`lab_results_${r||"all"}_${(new Date).toISOString().slice(0,10)}.${t}`;o.download=c,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(l)}catch(a){f(`Download failed: ${a.message}`)}finally{y(!1)}}),[s]);return g?m.jsx("div",{className:"min-h-screen bg-gray-100 py-6 flex flex-col justify-center sm:py-12",children:m.jsx("div",{className:"relative py-3 sm:max-w-xl sm:mx-auto",children:m.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:m.jsxs("div",{className:"flex",children:[m.jsx("div",{className:"flex-shrink-0",children:m.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:m.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),m.jsxs("div",{className:"ml-3",children:[m.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),m.jsx("div",{className:"mt-2 text-sm text-red-700",children:m.jsx("p",{children:g})}),m.jsx("div",{className:"mt-4",children:m.jsx("button",{onClick:()=>{f(""),D()},className:"bg-red-100 hover:bg-red-200 text-red-800 font-bold py-2 px-4 rounded transition-colors duration-150",children:"Retry"})})]})]})})})}):m.jsxs("div",{className:"min-h-screen bg-gray-100",children:[m.jsx("div",{className:"bg-white shadow",children:m.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:m.jsxs("div",{className:"flex justify-between items-center py-6",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-3xl font-bold leading-tight text-gray-900",children:"Laboratory Results Dashboard"}),m.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Showing ",N.length," of ",a.length," results"]})]}),m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsx("button",{onClick:()=>L("ldt"),disabled:b||0===a.length,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150",children:b?"Downloading...":"Download All LDT"}),m.jsx("button",{onClick:()=>L("pdf"),disabled:b||0===a.length,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-150",children:b?"Downloading...":"Download All PDF"}),m.jsx("button",{onClick:r,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-150",children:"Logout"})]})]})})}),m.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6",children:m.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:m.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[m.jsxs("div",{children:[m.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),m.jsx("input",{type:"text",id:"search",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-150",placeholder:"Search by patient name or result ID...",value:o,onChange:e=>d(e.target.value)})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),m.jsxs("select",{id:"status",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-150",value:c,onChange:e=>x(e.target.value),children:[m.jsx("option",{value:"",children:"All Statuses"}),C.map(e=>m.jsx("option",{value:e,children:e},e))]})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 mb-2",children:"Type"}),m.jsxs("select",{id:"type",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 transition-colors duration-150",value:u,onChange:e=>p(e.target.value),children:[m.jsx("option",{value:"",children:"All Types"}),_.map(e=>m.jsx("option",{value:e,children:e},e))]})]})]})})}),m.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 pb-6",children:m.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:n?m.jsx("div",{className:"flex items-center justify-center h-64",children:m.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600"})}):m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"overflow-x-auto",children:m.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[m.jsx("thead",{className:"bg-gray-50",children:m.jsxs("tr",{children:[m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result ID"}),m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),m.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),m.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(e=>m.jsx(h,{result:e,onDownload:L,downloading:b},e.id))})]})}),S>1&&m.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[m.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[m.jsx("button",{onClick:()=>j(Math.max(1,w-1)),disabled:1===w,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),m.jsx("button",{onClick:()=>j(Math.min(S,w+1)),disabled:w===S,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),m.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[m.jsx("div",{children:m.jsxs("p",{className:"text-sm text-gray-700",children:["Showing"," ",m.jsx("span",{className:"font-medium",children:(w-1)*v+1})," ","to"," ",m.jsx("span",{className:"font-medium",children:Math.min(w*v,N.length)})," ","of"," ",m.jsx("span",{className:"font-medium",children:N.length})," ","results"]})}),m.jsx("div",{children:m.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[m.jsx("button",{onClick:()=>j(Math.max(1,w-1)),disabled:1===w,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,S)},(e,t)=>{const s=Math.max(1,Math.min(S-4,w-2))+t;return m.jsx("button",{onClick:()=>j(s),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium "+(s===w?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:s},s)}),m.jsx("button",{onClick:()=>j(Math.min(S,w+1)),disabled:w===S,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})]})]})})})]})}),g=Object.freeze(Object.defineProperty({__proto__:null,default:p},Symbol.toStringTag,{value:"Module"}));export{g as R,m as j};
